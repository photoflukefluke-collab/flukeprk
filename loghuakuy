-- ‚ö†Ô∏è ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ webhook ‡∏´‡∏•‡∏∏‡∏î
_G.url_webhook_discord_send = _G.url_webhook_discord_send or "" 
_G.delay_send = _G.delay_send or 600 -- default = 10 ‡∏ô‡∏≤‡∏ó‡∏µ

task.wait(20) -- ‡∏£‡∏≠ 20 ‡∏ß‡∏¥‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°

repeat
    task.wait()
until game:IsLoaded() and game.Players.LocalPlayer

local LocalPlayer = game.Players.LocalPlayer
local HttpService = game:GetService("HttpService")

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ embed ‡∏ï‡∏≤‡∏° IcedTea
local function getColorByIcedTea(value)
    if value < 1000000 then -- < 1M
        return 0x2ECC71 -- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
    elseif value < 2000000 then -- 1M - 2M
        return 0xF1C40F -- ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
    elseif value < 3000000 then -- 2M - 3M
        return 0xE67E22 -- ‡∏™‡πâ‡∏°
    else -- >= 3M
        return 0xE74C3C -- ‡πÅ‡∏î‡∏á
    end
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á payload
local function buildPayload()
    local iced = LocalPlayer:GetAttribute("IcedTea") or 0
    local data = {
        content = nil,
        embeds = {
          {
            title = "*__üî• Map : Anime Vanguards üî•__*", -- ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤ + ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏µ‡∏¢‡∏á + emoji ‡πÑ‡∏ü‡∏´‡∏±‡∏ß‡∏ó‡πâ‡∏≤‡∏¢
            description = 
                "*Name :* **"..LocalPlayer.Name.."**\n"..  
                "*UserId :* **"..LocalPlayer.UserId.."**\n".. 
                "*Executor :* **"..(identifyexecutor and identifyexecutor() or "Unknown").."**",
            color = getColorByIcedTea(iced),
            fields = {
              {
                name = "***User Data***", -- ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤ + ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏µ‡∏¢‡∏á
                value = 
                    "üü¢ Level : `"..tostring(LocalPlayer:GetAttribute("Level")).."`\n".. 
                    "üí∞ Gold : `"..tostring(LocalPlayer:GetAttribute("Gold")).."`\n".. 
                    "üíé Gems : `"..tostring(LocalPlayer:GetAttribute("Gems")).."`\n".. 
                    "üå∏ Flowers : `"..tostring(LocalPlayer:GetAttribute("Flowers")).."`\n".. 
                    "ü•§ IcedTea : `"..tostring(iced).."`",
                inline = false
              },
            },
            footer = {
              text = "*By Fluke Parakorn*", -- ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏µ‡∏¢‡∏á
            },
            timestamp = DateTime.now():ToIsoDate(),
          },
        },
    }
    return HttpService:JSONEncode(data)
end

-- ‡∏™‡πà‡∏á Webhook
local headers = {["content-type"] = "application/json"}
local request = http_request or request or HttpPost

-- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î loop ‡∏™‡πà‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
_G.Workspace = true
task.spawn(function()
    while _G.Workspace do 
        local body = buildPayload()
        request({
            Url = _G.url_webhook_discord_send,
            Method = "POST",
            Headers = headers,
            Body = body
        })
        task.wait(_G.delay_send or 600)
    end
end)
